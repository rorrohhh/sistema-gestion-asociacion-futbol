<% if (jugadores && jugadores.length > 0) { %>
    <% jugadores.forEach(function(jugador) { %>
        
        <% 
            let edad = "--";
            if (jugador.fecha_nacimiento) {
                const hoy = new Date();
                const nacimiento = new Date(jugador.fecha_nacimiento);
                let anios = hoy.getFullYear() - nacimiento.getFullYear();
                const mes = hoy.getMonth() - nacimiento.getMonth();
                if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) {
                    anios--;
                }
                edad = anios;
            }
        %>

        <tr>
            <td class="ps-4"><span class="numero-camiseta"><%= jugador.numero %></span></td>
            <td>
                <div class="fw-bold text-dark"><%= jugador.apellido_paterno %> <%= jugador.apellido_materno %></div>
                <div class="text-muted small text-uppercase"><%= jugador.nombres %></div>
            </td>
            <td>
                <% if(jugador.rut_num) { %>
                    <span class="rut-font"><%= jugador.rut_num %>-<%= jugador.rut_dv %></span>
                <% } else { %>
                    <span class="text-muted">--</span>
                <% } %>
            </td>
            <td class="text-center"><span class="rol-badge border"><%= jugador.rol_asociacion %></span></td>
            
            <td class="text-center text-muted">
                <% if(jugador.fecha_nacimiento) { %>
                    <i class="bi bi-calendar3 me-1"></i>
                    <%= new Date(jugador.fecha_nacimiento).toLocaleDateString('es-CL') %>
                <% } else { %> -- <% } %>
            </td>

            <td class="text-center">
                <% if(edad !== "--") { %>
                    <span class="edad-badge"><%= edad %> a√±os</span>
                <% } else { %> -- <% } %>
            </td>

            <td><span class="badge rounded-pill text-bg-secondary club-tag px-3 py-2"><%= jugador.nombre_club %></span></td>
        </tr>
    <% }); %>
<% } else { %>
    <tr><td colspan="7" class="text-center py-5">No se encontraron jugadores.</td></tr>
<% } %>